package lms;



import java.io.EOFException;
import java.io.FileInputStream;
import java.io.FileNotFoundException;
import java.io.FileOutputStream;
import java.io.IOException;
import java.io.ObjectInputStream;
import java.io.ObjectOutputStream;
import java.io.Serializable;
import java.util.ArrayList;

public class Member extends Person implements Serializable {
private String memberID;
private Person member;
private Date startDate;

public Member(String memberID, Person member, Date startDate) {
	super();
	this.memberID = memberID;
	this.member = new Person(member);
	this.startDate = startDate;
}

public String getMemberID() {
	return memberID;
}

public void setMemberID(String memberID) {
	this.memberID = memberID;
}

public Person getMember() {
	return new Person(member);
}

public void setMember(Person member) {
	this.member = new Person(member);
}

public Date getStartDate() {
	return startDate;
}

public void setStartDate(Date startDate) {
	this.startDate = startDate;
}


public void addMember(Member m) { 
    ObjectOutputStream outputStream = null; 

	try {
		ArrayList<Member> MemberList = readMemberData();
		MemberList.add(m);

		outputStream = new ObjectOutputStream(new FileOutputStream("Members.ser"));
		
		for(int i = 0 ; i < MemberList.size() ; i++) {
			outputStream.writeObject(MemberList.get(i));
		}
	} catch(IOException e) {
		System.out.println("IO Exception while opening file");
	} finally { 
		try {
			if(outputStream != null) {
				outputStream.close();								
			}

		} catch (IOException e) {
			System.out.println("IO Exception while closing file");
		}
	}		
}


public ArrayList<Member> readMemberData(){
	ArrayList<Member> MemberList = new ArrayList<Member>(0);
	ObjectInputStream inputStream = null;
	try
	{
	inputStream = new ObjectInputStream(new FileInputStream("Members.ser"));
		boolean EOF = false;
		while(!EOF) {
			try {
				Member myObj = (Member) inputStream.readObject();
				MemberList.add(myObj);
				//System.out.println("Read: " + myObj.getName());
			} catch (ClassNotFoundException e) {
				//System.out.println("Class not found");
			} catch (EOFException end) {
				EOF = true;
			}
                    }
            }
	 catch(FileNotFoundException e) {
		//System.out.println("Cannot find file");
	} catch (IOException e) {
		//System.out.println("IO Exception while opening stream");
		//e.printStackTrace();
	} finally { 
		try {
			if(inputStream != null)
				inputStream.close( );
		} catch (IOException e) {
			System.out.println("IO Exception while closing file");
		}
	}
            
	return MemberList;
}

public void writeMemberList() {
	ObjectOutputStream outputStream = null; 

	try {
		ArrayList<Member> MemberList = readMemberData();

		outputStream = new ObjectOutputStream(new FileOutputStream("Members.ser"));
		
		for(int i = 0 ; i < MemberList.size() ; i++) {
			outputStream.writeObject(MemberList.get(i));
		}
	} catch(IOException e) {
		System.out.println("IO Exception while opening file");
	} finally { 
		try {
			if(outputStream != null) {
				outputStream.close();								
			}

		} catch (IOException e) {
			System.out.println("IO Exception while closing file");
		}
	}
}




}
